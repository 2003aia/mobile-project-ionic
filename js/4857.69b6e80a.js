"use strict";(self["webpackChunkstng"]=self["webpackChunkstng"]||[]).push([[4857],{1870:function(e,t,n){n.d(t,{d:function(){return d}});n(7658);var l=n(6086),a=n(9669),s=n.n(a),i=n(5241),o=n(3978);let r="https://fhd.aostng.ru/vesta/hs/API_STNG/V2/";const d=(0,l.Q_)({id:"preEntry",state:()=>({entryPhone:"",entryServiceType:"",entryDate:null,entryAvailableTimes:[],entryTime:null,entryNumber:null,availableDates:null,availableDatesError:null,availableTimeSlots:null,availableTimeSlotsError:null,postReserveResponse:null,postReserveError:null,deleteReserveError:null,deleteReserveResponse:null,reserveData:null,getReserveResponse:null,getReserveError:null}),getters:{getEntryInfo:e=>({entryPhone:e.entryPhone,entryServiceType:e.entryServiceType,entryDate:e.entryDate,entryAvailableTimes:e.entryAvailableTimes,entryTime:e.entryTime})},actions:{async getDates(e){try{await s().get(`${r}/elGetDatas?operation=${e}`).then((e=>this.availableDates=e.data))}catch(t){this.availableDatesError=t}},async getTimeSlots(e,t){try{await s().get(`${r}/elGetTimes?operation=${e}&date=${t}`).then((e=>this.availableTimeSlots=e.data))}catch(n){this.availableTimeSlotsError=n}},async postReserve(e){try{await s().post(`${r}/elReserve`,e).then((e=>this.postReserveResponse=e.data))}catch(t){this.postReserveError=t}},async deleteReserve(e){try{await s().get(`${r}/elDelete?id=${e}`).then((e=>this.deleteReserveResponse=e.data))}catch(t){this.deleteReserveError=t}},async getReserve(){const e=new o.K;await e.create();const t=await e.get("token"),n=JSON.parse(t);try{await s().get(`${r}/elQueye?token=${n?.token}`).then((e=>this.getReserveResponse=e.data))}catch(l){this.getReserveError=l}},async setPhone(e){this.entryPhone=e},async setServiceType(e){this.entryServiceType=e},async setDate(e){this.entryDate=e},async setTime(e){this.entryTime=e},async fetchTime(){if(this.entryDate&&""!=this.entryServiceType)try{let t={headers:{Accept:"*/*","Content-Type":"multipart/form-data"}},n="android";(0,i.a)("iphone")&&(n="iphone");var e=new FormData;e.append("date",this.entryDate),e.append("service",this.entryServiceType),e.append("ionicDevice",n);const l=await s().post("https://aostng.ru/ajax/preregajax.php",e,t);let a=[];const o=/>([^<.]+)<\//g;let r=o.exec(l.data);while(null!=r)a.push(r[1]),r=o.exec(l.data);this.entryTime=null,this.entryAvailableTimes=a}catch(t){console.log(t)}},async sendFullInfo(e,t,n,l){console.log(e,t,n,l);try{let o={headers:{Accept:"*/*","Content-Type":"multipart/form-data"}},r="android";(0,i.a)("iphone")&&(r="iphone");var a=new FormData;return a.append("number",e),a.append("service",t),a.append("date",n),a.append("time",l),a.append("ionicDevice",r),await s().post("https://aostng.ru/prereg2.php",a,o).then((e=>{this.entryNumber=e.data.split("Номер вашей брони - </span>")[1]})),!0}catch(o){return!1}},async resetPreEntry(){this.entryPhone="",this.entryServiceType="",this.entryDate=null,this.entryAvailableTimes=[],this.entryTime=null}}})},7717:function(e,t,n){n.d(t,{Z:function(){return d}});var l=n(6252),a=n(3577);function s(e,t,n,s,i,o){return(0,l.wg)(),(0,l.iD)("div",{class:(0,a.C_)({main:!0,padding:e.padding,bgBlue:e.bgBlue}),onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},[(0,l.WI)(e.$slots,"content",{},void 0,!0)],2)}var i=(0,l.aZ)({setup(){},name:"layoutBox",components:{},props:{padding:Boolean,btnSrc:String,filledButton:String,title:String,height:String,onClick:Function,bgBlue:Boolean}}),o=n(3744);const r=(0,o.Z)(i,[["render",s],["__scopeId","data-v-7ef2f989"]]);var d=r},4857:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var l=n(6252),a=n(3577),s=n(9963);const i={class:"title ion-text-start"},o={class:"title ion-text-start"};function r(e,t,n,r,d,u){const c=(0,l.up)("Back"),p=(0,l.up)("ion-text"),v=(0,l.up)("ion-icon"),h=(0,l.up)("ion-spinner"),y=(0,l.up)("ion-item"),g=(0,l.up)("ion-content"),m=(0,l.up)("ion-popover"),w=(0,l.up)("LayoutBox"),f=(0,l.up)("Layout"),_=(0,l.up)("ion-page");return(0,l.wg)(),(0,l.j4)(_,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c),(0,l.Wm)(f,{btnSrc:"/tabs/record",height:"false",outlineBtn:".",filledBtn:".",title:"Мои заявки"},{"main-content":(0,l.w5)((()=>[(0,l.wy)((0,l._)("div",null,[(0,l.Wm)(y,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l._)("p",i,(0,a.zw)(e.operationConverter(e.el[0]?.operation)),1)])),_:1}),(0,l.Wm)(v,{slot:"end",onClick:t[0]||(t[0]=t=>{e.el[0].open=!0,e.el[0].event=t}),icon:e.ellipsisVertical},null,8,["icon"]),(0,l.Wm)(m,{class:"history-wrapper",mode:"ios",event:e.el[0]?.event,"is-open":e.el[0]?.open},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"ion-padding"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(y,{lines:"nonse",onClick:t[1]||(t[1]=t=>{e.loadingDel=!0,e.deleteReserve(e.el[0]?.ID).then((()=>{e.el[0].open=!1,e.el[0].event=t,e.loadingDel=!1,e.loading=!0,e.getReserve().then((()=>{e.loading=!1}))}))})},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Удалить")])),_:1}),!1===e.loadingDel?((0,l.wg)(),(0,l.j4)(v,{key:0,class:"history-icon",icon:e.trashOutline,slot:"end"},null,8,["icon"])):((0,l.wg)(),(0,l.j4)(h,{key:1,class:"delSpinner",slot:"end",name:"bubbles"}))])),_:1})])])),_:1})])),_:1},8,["event","is-open"])])),_:1}),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Время: ")])),_:1}),(0,l.Wm)(p,{slot:"end",class:"text-blue"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.el[0]?.slot),1)])),_:1})])),_:1}),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Uk)("ПИН-код: ")])),_:1}),(0,l.Wm)(p,{slot:"end",class:"text-blue"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.el[0]?.PINCode),1)])),_:1})])),_:1})],512),[[s.F8,!e.loading&&e.el?.length>0]]),(0,l.wy)((0,l._)("div",null,[(0,l.Wm)(y,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{name:"bubbles"})])),_:1})],512),[[s.F8,e.loading]]),(0,l.wy)((0,l._)("div",null,[(0,l.Wm)(y,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Заявок нет ")])),_:1})],512),[[s.F8,0===e.el?.length&&!e.loading]])])),content:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.el2,(t=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{key:t},[(0,l.Wm)(w,null,{content:(0,l.w5)((()=>[(0,l.Wm)(y,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l._)("p",o,(0,a.zw)(e.operationConverter(t?.operation)),1)])),_:2},1024),(0,l.Wm)(v,{slot:"end",onClick:e=>{t.open=!0,t.event=e},icon:e.ellipsisVertical},null,8,["onClick","icon"]),(0,l.Wm)(m,{class:"history-wrapper",mode:"ios",event:t?.event,"is-open":t?.open},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"ion-padding"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(y,{lines:"nonse",onClick:n=>{e.loadingDel=!0,e.deleteReserve(t?.ID).then((()=>{t.open=!1,t.event=n,e.loadingDel=!1,e.loading=!0,e.getReserve().then((()=>{e.loading=!1}))}))}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Удалить")])),_:1}),!1===e.loadingDel?((0,l.wg)(),(0,l.j4)(v,{key:0,class:"history-icon",icon:e.trashOutline,slot:"end"},null,8,["icon"])):((0,l.wg)(),(0,l.j4)(h,{key:1,class:"delSpinner",slot:"end",name:"bubbles"}))])),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1032,["event","is-open"])])),_:2},1024),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Время: ")])),_:1}),(0,l.Wm)(p,{slot:"end",class:"text-blue"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(t?.slot),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Uk)("ПИН-код: ")])),_:1}),(0,l.Wm)(p,{slot:"end",class:"text-blue"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(t?.PINCode),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),[[s.F8,!e.loading]]))),128))])),_:1})])),_:1})}var d=n(2201),u=n(1993),c=n(7821),p=n(8903),v=n(23),h=n(7717),y=n(1870),g=(0,l.aZ)({name:"recordsPage",components:{Back:v.Z,IonItem:c.Ie,IonPage:c._i,Layout:u.Z,IonText:c.yW,LayoutBox:h.Z,IonPopover:c.d8,IonIcon:c.gu,IonContent:c.W2,IonSpinner:c.PQ},data(){return{loadingDel:!1,loading:!1}},computed:{el(){return this.$pinia.state.value.preEntry.getReserveResponse?.data||[]},el2(){return[...this.el.slice(1)]}},ionViewDidEnter(){this.$data.loading=!0,this.getReserve().then((()=>this.$data.loading=!1))},methods:{async deleteHandler(e){console.log(e,"testdelete")},operationConverter(e){switch(e){case"12":return"Прием документов";case"14":return"Договор на поставку газа";case"16":return"Соц. газификация";default:break}}},setup(){const e=(0,d.tv)(),{getReserve:t,deleteReserve:n}=(0,y.d)();return{router:e,pencilOutline:p.Tvs,documentTextOutline:p.L82,chevronForwardOutline:p.Dji,trashOutline:p.gtu,ellipsisVertical:p.LHl,getReserve:t,deleteReserve:n}}}),m=n(3744);const w=(0,m.Z)(g,[["render",r],["__scopeId","data-v-13d80650"]]);var f=w}}]);
//# sourceMappingURL=4857.69b6e80a.js.map