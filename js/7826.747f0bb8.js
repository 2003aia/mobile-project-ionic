"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[7826],{6651:function(t,e,s){s.d(e,{U:function(){return r}});var a=s(6086),n=s(9669),o=s.n(n),l=s(3978);const r=(0,a.Q_)({id:"personalAccount",state:()=>({addAccountResponse:null,addAccountError:null,getSettlementsResponse:null,getSettlementsError:null,getStreetsResponse:null,getStreetsError:null,getHousesResponse:null,getHousesError:null,getAccountResponse:null,paymentHistoryResponse:null,paymentHistoryError:null,sberPayResponse:null,sberPayError:null,getAccountError:null,delAccountResponse:{error:!1,data:null},delAccountError:null,getIndicesResponse:null,getIndicesError:null,setIndicesResponse:null,setIndicesError:null,personalItemData:{}}),getters:{getSettlementsList:t=>t.getSettlementsResponse.data.flatMap((t=>t?.settlements.flatMap((t=>t))))},actions:{async getSettlements(){console.log("getting settlements");try{const t=new l.K;await t.create();const e=await t.get("token"),s=JSON.parse(e).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetSettlements",{token:s}).then((t=>this.getSettlementsResponse=t.data))}catch(t){this.getSettlementsError=t}},async getStreets(t){try{const e=new l.K;await e.create();const s=await e.get("token"),a=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetStreets",{token:a,s_id:t}).then((t=>this.getStreetsResponse=t.data))}catch(e){this.getStreetsError=e}},async getHouses(t){try{const e=new l.K;await e.create();const s=await e.get("token"),a=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetHouses",{token:a,ids:t}).then((t=>this.getHousesResponse=t.data))}catch(e){this.getHousesError=e}},async getAccount(){try{const t=new l.K;await t.create();const e=await t.get("token"),s=JSON.parse(e).token,a=JSON.parse(e).lics;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetAccount",{token:s,LC:a}).then((t=>this.getAccountResponse=t.data))}catch(t){this.getAccountError=t}},async addAccount(t,e){try{await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/AddAccount",{token:t,LC:e}).then((async t=>{this.addAccountResponse=t.data;const s=new l.K;await s.create();const a=await s.get("token"),n=JSON.parse(a);await s.set("token",JSON.stringify({...n,lics:[...n.lics,e]}))}))}catch(s){this.addAccountError=s}},async delAccount(t){try{const e=new l.K;await e.create();const s=await e.get("token"),a=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/DelAccount",{token:a,LC:t}).then((async a=>{this.getAccountResponse.data=this.getAccountResponse?.data.filter((e=>e.code!==t));const n=JSON.parse(s),o=this.getAccountResponse?.data.filter((e=>e?.code!==t)),l={name:n.name,phone:n.phone,email:n.email,password:n.password,token:n.token,lics:o?.map((t=>t?.code))};await e.set("token",JSON.stringify(l)),this.delAccountResponse=a.data}))}catch(e){this.delAccountError=e}},async getPayments(t){try{const e=new l.K;await e.create();const s=await e.get("token"),a=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetPayments",{token:a,LC:t}).then((async t=>{this.paymentHistoryResponse=t.data}))}catch(e){this.paymentHistoryError=e}},async getIndices(t){try{const e=new l.K;await e.create();const s=await e.get("token"),a=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetIndices",{token:a,counterId:t}).then((t=>{this.getIndicesResponse=t.data}))}catch(e){this.getIndicesError=e}},async setIndices(t,e){try{const s=new l.K;await s.create();const a=await s.get("token"),n=JSON.parse(a).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/SetIndices",{token:n,counterId:t,indice:e}).then((e=>{!1===e.data.error&&(this.getIndices(t),this.setIndicesResponse=e.data)}))}catch(s){this.setIndicesError=s}},async sberPay(t,e,s,a,n,r,i){try{const c=new l.K;await c.create();const u=await c.get("token"),d=JSON.parse(u);await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/SberPay",{token:d.token,phone:e,email:s,LC:t,accruals:a,penalties:r,advances:i,sumTO:n}).then((t=>{this.sberPayResponse=t.data}))}catch(c){this.sberPayError=c}}}})},7826:function(t,e,s){s.r(e),s.d(e,{default:function(){return V}});var a=s(6252),n=s(9963),o=s(3577);const l=t=>((0,a.dD)("data-v-01d0fc2c"),t=t(),(0,a.Cn)(),t),r=l((()=>(0,a._)("p",{class:"title ion-text-start"},"Узнать лицевой счет",-1))),i={class:"input-wrapper",slot:"header"},c={slot:"content"},u={class:"input-wrapper",slot:"header"},d={slot:"content"},p={class:"input-wrapper",slot:"header"},h={slot:"content"},w={class:"input-wrapper",slot:"header"},g={slot:"content"},m={class:"ion-text-start"},f={class:"ion-text-start"},_={class:"ion-text-start"},y={class:"ion-text-start"},k={class:"blue"},v={class:"ion-text-start error"};function S(t,e,s,l,S,A){const L=(0,a.up)("Back"),W=(0,a.up)("ion-text"),$=(0,a.up)("ion-spinner"),I=(0,a.up)("ion-item"),H=(0,a.up)("ion-accordion"),R=(0,a.up)("ion-accordion-group"),C=(0,a.up)("ion-checkbox"),N=(0,a.up)("Layout"),P=(0,a.up)("ion-page");return(0,a.wg)(),(0,a.j4)(P,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L),(0,a.Wm)(N,{method2:t.addAccountHandler,height:"false",outlineBtn:"Добавить лицевой счёт",filledBtn:".",loading2:t.loading,title:"Лицевой счёт"},{"main-content":(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[r])),_:1}),(0,a.Wm)(R,{ref:"accordion"},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{value:"first","toggle-icon":t.caretDownSharp},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=e=>t.country=e),class:"input",placeholder:"Введите населенный пункт по улусам"},null,512),[[n.nr,t.country]])]),(0,a._)("div",c,[(0,a.wy)((0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)($,{name:"bubbles"})])),_:1},512),[[n.F8,t.loading2]]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.settlementsList,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.s_id},[(0,a.Wm)(I,{onClick:s=>t.fetchStreetsHandler(e.s_id,e.settlement)},{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.settlement),1)])),_:2},1024)])),_:2},1032,["onClick"])])))),128)),(0,a.wy)((0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)("не найдено")])),_:1})])),_:1},512),[[n.F8,0===t.settlementsList?.length]])])])),_:1},8,["toggle-icon"]),(0,a.Wm)(H,{value:"second","toggle-icon":t.caretDownSharp},{default:(0,a.w5)((()=>[(0,a._)("div",u,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=e=>t.street=e),class:"input",placeholder:"Введите улицу"},null,512),[[n.nr,t.street]])]),(0,a._)("div",d,[(0,a.wy)((0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)($,{name:"bubbles"})])),_:1},512),[[n.F8,t.loading3]]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.streetsList,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.street},[(0,a.Wm)(I,{onClick:s=>t.fetchHousesHandler(e.ids,e.street)},{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.street),1)])),_:2},1024)])),_:2},1032,["onClick"])])))),128)),(0,a.wy)((0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)("не найдено")])),_:1})])),_:1},512),[[n.F8,0===t.streetsList?.length]])])])),_:1},8,["toggle-icon"]),(0,a.Wm)(H,{value:"third","toggle-icon":t.caretDownSharp},{default:(0,a.w5)((()=>[(0,a._)("div",p,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=e=>t.house=e),class:"input",placeholder:"Введите дом улицы"},null,512),[[n.nr,t.house]])]),(0,a._)("div",h,[(0,a.wy)((0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)($,{name:"bubbles"})])),_:1},512),[[n.F8,t.loading4]]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.housesList,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a.Wm)(I,{onClick:s=>t.fetchLicsHandler(e?.house)},{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e?.house),1)])),_:2},1024)])),_:2},1032,["onClick"])])))),128)),(0,a.wy)((0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)("не найдено")])),_:1})])),_:1},512),[[n.F8,0===t.housesList?.length]])])])),_:1},8,["toggle-icon"]),(0,a.wy)((0,a.Wm)(H,{value:"fourth","toggle-icon":t.caretDownSharp},{default:(0,a.w5)((()=>[(0,a._)("div",w,[(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=e=>t.apartment=e),class:"input",placeholder:"Введите номер квартиры"},null,512),[[n.nr,t.apartment]])]),(0,a._)("div",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.apartmentsList,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a.Wm)(I,{onClick:s=>t.fetchLicsHandler2(e?.apartment)},{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e?.apartment),1)])),_:2},1024)])),_:2},1032,["onClick"])])))),128)),(0,a.wy)((0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)("не найдено")])),_:1})])),_:1},512),[[n.F8,0===t.apartmentsList?.length]])])])),_:1},8,["toggle-icon"]),[[n.F8,0!==t.housesList?.length&&void 0!==t.housesList&&t.housesList[0]?.apartments]])])),_:1},512),(0,a.wy)((0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.licsList,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t?.lics,(t=>((0,a.wg)(),(0,a.j4)(W,{key:t?.code},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{lines:"none",class:"check"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{class:"lics",slot:"start"},{default:(0,a.w5)((()=>[(0,a._)("p",m,"Лицевой счет: "+(0,o.zw)(t?.code),1),(0,a._)("p",f," Наименование лицевого счета: "+(0,o.zw)(t?.name),1)])),_:2},1024),(0,a.Wm)(C,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,slot:"end"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128))])))),128))],512),[[n.F8,0!==t.licsList?.length]]),(0,a.wy)((0,a._)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.licsApartmentsList,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t?.lics,(t=>((0,a.wg)(),(0,a.j4)(W,{key:t?.code},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{class:"check",lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{class:"lics",slot:"start"},{default:(0,a.w5)((()=>[(0,a._)("p",_,"Лицевой счет: "+(0,o.zw)(t?.code),1),(0,a._)("p",y," Наименование лицевого счета: "+(0,o.zw)(t?.name),1)])),_:2},1024),(0,a.Wm)(C,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,slot:"end"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128))])))),128))],512),[[n.F8,0!==t.housesList?.length&&void 0!==t.housesList&&t.housesList[0]?.apartments&&0!==t.licsApartmentsList?.length]]),(0,a.wy)((0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a._)("p",k,(0,o.zw)(t.response),1)])),_:1},512),[[n.F8,0!==t.response?.length]]),(0,a.wy)((0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a._)("p",v,(0,o.zw)(t.error),1)])),_:1},512),[[n.F8,0!==t.error?.length]])])),_:1},8,["method2","loading2"])])),_:1})}s(7658);var A=s(2201),L=s(594),W=s(526),$=s(8903),I=s(4043),H=s(3978),R=s(6086),C=s(6651),N=(0,a.aZ)({name:"personalAccauntInfoSearchPage",components:{IonAccordionGroup:W.eh,IonAccordion:W.We,Back:I.Z,IonPage:W._i,Layout:L.Z,IonText:W.yW,IonItem:W.Ie,IonSpinner:W.PQ,IonCheckbox:W.nz},data(){return{error:"",house:"",street:"",country:"",apartment:"",lc:[],loading:!1,response:[],arrMapLics:[],loading2:!0,loading3:!1,loading4:!1}},computed:{settlementsList(){return this.$pinia.state.value?.personalAccount?.getSettlementsResponse?.data.flatMap((t=>t.settlements.flatMap((t=>t)))).filter((t=>t.settlement.toLowerCase().includes(this.$data.country.toLowerCase())))},streetsList(){return this.$pinia.state.value?.personalAccount?.getStreetsResponse?.data.flatMap((t=>t)).filter((t=>t.street.toLowerCase().includes(this.$data.street.toLowerCase())))},housesList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t)).filter((t=>t.house.toLowerCase().includes(this.$data.house.toLowerCase())))},apartmentsList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t?.apartments?.flatMap((t=>t)))).filter((t=>t?.apartment?.toLowerCase().includes(this.$data.apartment.toLowerCase())))},licsApartmentsList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t?.apartments?.flatMap((t=>t)))).filter((t=>t?.apartment?.toLowerCase()===this.$data.apartment.toLowerCase()))},licsList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t)).filter((t=>t.house.toLowerCase()===this.$data.house.toLowerCase()))}},mounted(){const t=new Promise((t=>{t(this.getSettlements())}));t.then((()=>this.$data.loading2=!1))},methods:{...(0,R.nv)(C.U,["getSettlements","getStreets","getHouses","addAccount","getAccount"]),onFocusText:function(){console.log("focus"),this.$refs.text.focus()},fetchStreetsHandler(t,e){this.$data.loading3=!0;const s=new Promise((e=>{e(this.getStreets(t))}));s.then((()=>this.$data.loading3=!1)),this.$refs.accordion.$el.value=void 0,this.$data.country=e},fetchHousesHandler(t,e){this.$data.loading4=!0;const s=new Promise((e=>{e(this.getHouses(t))}));s.then((()=>this.$data.loading4=!1)),this.$refs.accordion.$el.value=void 0,this.$data.street=e},fetchLicsHandler(t){this.$refs.accordion.$el.value=void 0,this.$data.house=t},fetchLicsHandler2(t){this.$refs.accordion.$el.value=void 0,this.$data.apartment=t},async addAccountHandler(){const t=new H.K;await t.create();const e=await t.get("token"),s=this.licsList[0]?.lics?.filter((t=>!0===t?.value)),a=this.licsApartmentsList[0]?.lics?.filter((t=>!0===t?.value));if(0!==s?.length&&void 0!==s||0!==a?.length&&void 0!==a){this.$data.loading=!0;const t=void 0!==s?s?.map((t=>t?.code)):a?.map((t=>t?.code)),n=new Promise((s=>{s(this.addAccount(JSON.parse(e).token,t))}));n.then((()=>{this.$data.error="",this.getAccount().then((()=>{this.$router.push("/tabs/personalAccounts")})),this.$data.loading=!1,this.$data.response=this.$pinia.state.value.personalAccount?.addAccountResponse[0]?.message}))}else this.$data.response="",this.$data.error="Выберите лицевой счет"}},setup(){const t=(0,A.tv)();return{router:t,pencilOutline:$.Tvs,documentTextOutline:$.L82,chevronForwardOutline:$.Dji,caretDownSharp:$.D2O}}}),P=s(3744);const D=(0,P.Z)(N,[["render",S],["__scopeId","data-v-01d0fc2c"]]);var V=D}}]);
//# sourceMappingURL=7826.747f0bb8.js.map