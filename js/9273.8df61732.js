"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[9273],{6651:function(t,e,s){s.d(e,{U:function(){return c}});var n=s(6086),a=s(9669),o=s.n(a),r=s(3978);const c=(0,n.Q_)({id:"personalAccount",state:()=>({addAccountResponse:null,addAccountError:null,getSettlementsResponse:null,getSettlementsError:null,getStreetsResponse:null,getStreetsError:null,getHousesResponse:null,getHousesError:null,getAccountResponse:null,paymentHistoryResponse:null,paymentHistoryError:null,sberPayResponse:null,sberPayError:null,getAccountError:null,delAccountResponse:{error:!1,data:null},delAccountError:null,getIndicesResponse:null,getIndicesError:null,setIndicesResponse:null,setIndicesError:null,personalItemData:{}}),getters:{getSettlementsList:t=>t.getSettlementsResponse.data.flatMap((t=>t?.settlements.flatMap((t=>t))))},actions:{async getSettlements(){console.log("getting settlements");try{const t=new r.K;await t.create();const e=await t.get("token"),s=JSON.parse(e).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetSettlements",{token:s}).then((t=>this.getSettlementsResponse=t.data))}catch(t){this.getSettlementsError=t}},async getStreets(t){try{const e=new r.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetStreets",{token:n,s_id:t}).then((t=>this.getStreetsResponse=t.data))}catch(e){this.getStreetsError=e}},async getHouses(t){try{const e=new r.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetHouses",{token:n,ids:t}).then((t=>this.getHousesResponse=t.data))}catch(e){this.getHousesError=e}},async getAccount(){try{const t=new r.K;await t.create();const e=await t.get("token"),s=JSON.parse(e).token,n=JSON.parse(e).lics;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetAccount",{token:s,LC:n}).then((t=>this.getAccountResponse=t.data))}catch(t){this.getAccountError=t}},async addAccount(t,e){try{await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/AddAccount",{token:t,LC:e}).then((async t=>{this.addAccountResponse=t.data;const s=new r.K;await s.create();const n=await s.get("token"),a=JSON.parse(n);await s.set("token",JSON.stringify({...a,lics:[...a.lics,e]}))}))}catch(s){this.addAccountError=s}},async delAccount(t){try{const e=new r.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/DelAccount",{token:n,LC:t}).then((async n=>{this.getAccountResponse.data=this.getAccountResponse?.data.filter((e=>e.code!==t));const a=JSON.parse(s),o=this.getAccountResponse?.data.filter((e=>e?.code!==t)),r={name:a.name,phone:a.phone,email:a.email,password:a.password,token:a.token,lics:o?.map((t=>t?.code))};await e.set("token",JSON.stringify(r)),this.delAccountResponse=n.data}))}catch(e){this.delAccountError=e}},async getPayments(t){try{const e=new r.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetPayments",{token:n,LC:t}).then((async t=>{this.paymentHistoryResponse=t.data}))}catch(e){this.paymentHistoryError=e}},async getIndices(t){try{const e=new r.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetIndices",{token:n,counterId:t}).then((t=>{this.getIndicesResponse=t.data}))}catch(e){this.getIndicesError=e}},async setIndices(t,e){try{const s=new r.K;await s.create();const n=await s.get("token"),a=JSON.parse(n).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/SetIndices",{token:a,counterId:t,indice:e}).then((e=>{!1===e.data.error&&(this.getIndices(t),this.setIndicesResponse=e.data)}))}catch(s){this.setIndicesError=s}},async sberPay(t,e,s,n,a,c,i){try{const l=new r.K;await l.create();const u=await l.get("token"),p=JSON.parse(u);await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/SberPay",{token:p.token,phone:e,email:s,LC:t,accruals:n,penalties:c,advances:i,sumTO:a}).then((t=>{this.sberPayResponse=t.data}))}catch(l){this.sberPayError=l}}}})},9273:function(t,e,s){s.r(e),s.d(e,{default:function(){return k}});var n=s(6252),a=s(3577);const o={key:0},r={key:1};function c(t,e,s,c,i,l){const u=(0,n.up)("Back"),p=(0,n.up)("ion-text"),d=(0,n.up)("ion-col"),h=(0,n.up)("ion-row"),g=(0,n.up)("ion-spinner"),w=(0,n.up)("Layout"),y=(0,n.up)("ion-page");return(0,n.wg)(),(0,n.j4)(y,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u),(0,n.Wm)(w,{btnSrc:"/personalAccountPayment",height:"false",outlineBtn:".",filledBtn:".",title:"Лицевые счета"},{"header-content":(0,n.w5)((()=>[(0,n.Wm)(p,{class:"main-title"},{default:(0,n.w5)((()=>[(0,n.Uk)("История платежей")])),_:1})])),"main-content":(0,n.w5)((()=>[0===t.paymentHistory?.length?((0,n.wg)(),(0,n.iD)("div",o,[(0,n.Wm)(p,null,{default:(0,n.w5)((()=>[(0,n.Uk)("У №"+(0,a.zw)(t.route.params?.lc)+" лицевого счета нет платежей",1)])),_:1})])):((0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Uk)("№")])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Uk)("Дата")])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Uk)("Сумма")])),_:1}),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Uk)("Автор")])),_:1})])),_:1}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.paymentHistory,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e},[(0,n.Wm)(h,{class:(0,a.C_)({"ion-row-last":t.paymentHistory[t.paymentHistory?.length-1]?.number===e?.number})},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{class:"sub-title"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e?.number),1)])),_:2},1024),(0,n.Wm)(d,{class:"sub-title"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e?.date?e?.date:"-"),1)])),_:2},1024),(0,n.Wm)(d,{class:"sub-title"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.maskMoney(e?.summ)),1)])),_:2},1024),(0,n.Wm)(d,{class:"sub-title"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e?.author),1)])),_:2},1024)])),_:2},1032,["class"])])))),128))]))])),default:(0,n.w5)((()=>[(0,n.Wm)(g,{name:"bubbles"})])),_:1})])),_:1})}var i=s(2201),l=s(594),u=s(526),p=s(8903),d=s(4043),h=s(6086),g=s(6651),w=(0,n.aZ)({name:"personalAccountPaymentHistory",components:{Back:d.Z,IonPage:u._i,Layout:l.Z,IonText:u.yW,IonSpinner:u.PQ,IonCol:u.wI,IonRow:u.Nd},methods:{...(0,h.nv)(g.U,["getPayments"]),maskMoney(t){const e=t;return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e/100)}},computed:{paymentHistory(){return this.$pinia.state.value?.personalAccount?.paymentHistoryResponse?.data[0]?.payments?this.$pinia.state.value?.personalAccount?.paymentHistoryResponse?.data[0]?.payments:[]},paymentHistory2(){return[...this.paymentHistory.slice(1)]}},mounted(){this.getPayments(this.$pinia.state.value?.personalAccount?.personalItemData?.code)},data(){return{}},setup(){const t=(0,i.tv)(),e=(0,i.yj)();return{route:e,router:t,pencilOutline:p.Tvs,documentTextOutline:p.L82,chevronForwardOutline:p.Dji}}}),y=s(3744);const m=(0,y.Z)(w,[["render",c],["__scopeId","data-v-ed927560"]]);var k=m}}]);
//# sourceMappingURL=9273.8df61732.js.map