"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[4841],{6651:function(t,e,s){s.d(e,{U:function(){return i}});var n=s(6086),a=s(9669),o=s.n(a),l=s(3978);const i=(0,n.Q_)({id:"personalAccount",state:()=>({addAccountResponse:null,addAccountError:null,getSettlementsResponse:null,getSettlementsError:null,getStreetsResponse:null,getStreetsError:null,getHousesResponse:null,getHousesError:null,getAccountResponse:null,paymentHistoryResponse:null,paymentHistoryError:null,sberPayResponse:null,sberPayError:null,getAccountError:null,delAccountResponse:{error:!1,data:null},delAccountError:null,getIndicesResponse:null,getIndicesError:null,setIndicesResponse:null,setIndicesError:null,personalItemData:{}}),getters:{getSettlementsList:t=>t.getSettlementsResponse.data.flatMap((t=>t?.settlements.flatMap((t=>t))))},actions:{async getSettlements(){console.log("getting settlements");try{const t=new l.K;await t.create();const e=await t.get("token"),s=JSON.parse(e).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetSettlements",{token:s}).then((t=>this.getSettlementsResponse=t.data))}catch(t){this.getSettlementsError=t}},async getStreets(t){try{const e=new l.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetStreets",{token:n,s_id:t}).then((t=>this.getStreetsResponse=t.data))}catch(e){this.getStreetsError=e}},async getHouses(t){try{const e=new l.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetHouses",{token:n,ids:t}).then((t=>this.getHousesResponse=t.data))}catch(e){this.getHousesError=e}},async getAccount(){try{const t=new l.K;await t.create();const e=await t.get("token"),s=JSON.parse(e).token,n=JSON.parse(e).lics;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetAccount",{token:s,LC:n}).then((t=>this.getAccountResponse=t.data))}catch(t){this.getAccountError=t}},async addAccount(t,e){try{await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/AddAccount",{token:t,LC:e}).then((async t=>{this.addAccountResponse=t.data;const s=new l.K;await s.create();const n=await s.get("token"),a=JSON.parse(n);await s.set("token",JSON.stringify({...a,lics:[...a.lics,e]}))}))}catch(s){this.addAccountError=s}},async delAccount(t){try{const e=new l.K;await e.create();const s=await e.get("token"),n=JSON.parse(s).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/DelAccount",{token:n,LC:t}).then((async n=>{this.getAccountResponse.data=this.getAccountResponse?.data.filter((e=>e.code!==t));const a=JSON.parse(s),o=this.getAccountResponse?.data.filter((e=>e?.code!==t)),l={name:a.name,phone:a.phone,email:a.email,password:a.password,token:a.token,lics:o?.map((t=>t?.code))};await e.set("token",JSON.stringify(l)),this.delAccountResponse=n.data}))}catch(e){this.delAccountError=e}},async getPayments(t,e,s){try{const n=new l.K;await n.create();const a=await n.get("token"),i=JSON.parse(a).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetPayments",{token:i,LC:t,beginDate:e,endDate:s}).then((async t=>{this.paymentHistoryResponse=t.data}))}catch(n){this.paymentHistoryError=n}},async getIndices(t,e,s){try{const n=new l.K;await n.create();const a=await n.get("token"),i=JSON.parse(a).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/GetIndices",{token:i,counterId:t,beginDate:e,endDate:s}).then((t=>{this.getIndicesResponse=t.data}))}catch(n){this.getIndicesError=n}},async setIndices(t,e){try{const s=new l.K;await s.create();const n=await s.get("token"),a=JSON.parse(n).token;await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/SetIndices",{token:a,counterId:t,indice:e}).then((e=>{!1===e.data.error&&(this.getIndices(t),this.setIndicesResponse=e.data)}))}catch(s){this.setIndicesError=s}},async sberPay(t,e,s,n,a,i,r){try{const c=new l.K;await c.create();const u=await c.get("token"),d=JSON.parse(u);await o().post("https://fhd.aostng.ru/vesta_storage/hs/API_STNG/V2/SberPay",{token:d.token,phone:e,email:s,LC:t,accruals:n,penalties:i,advances:r,sumTO:a}).then((t=>{this.sberPayResponse=t.data}))}catch(c){this.sberPayError=c}}}})},4841:function(t,e,s){s.r(e),s.d(e,{default:function(){return U}});var n=s(6252),a=s(9963),o=s(3577);const l=t=>((0,n.dD)("data-v-553e7078"),t=t(),(0,n.Cn)(),t),i=l((()=>(0,n._)("p",{class:"title ion-text-start"},"Узнать лицевой счет",-1))),r={class:"input-wrapper",slot:"header"},c={slot:"content"},u={class:"input-wrapper",slot:"header"},d={slot:"content"},h={class:"input-wrapper",slot:"header"},p={slot:"content"},w={class:"input-wrapper",slot:"header"},g={slot:"content"},m={class:"input-wrapper",slot:"header"},f={slot:"content"},_={class:"ion-text-start"},y={class:"ion-text-start"},k={class:"ion-text-start"},v={class:"ion-text-start"},L={class:"blue"},S={class:"ion-text-start error"};function A(t,e,s,l,A,W){const $=(0,n.up)("Back"),I=(0,n.up)("ion-text"),H=(0,n.up)("ion-spinner"),C=(0,n.up)("ion-item"),D=(0,n.up)("ion-accordion"),R=(0,n.up)("ion-accordion-group"),N=(0,n.up)("ion-checkbox"),P=(0,n.up)("Layout"),b=(0,n.up)("ion-page");return(0,n.wg)(),(0,n.j4)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)($),(0,n.Wm)(P,{method2:t.addAccountHandler,height:"false",outlineBtn:"Добавить лицевой счёт",filledBtn:".",loading2:t.loading,title:"Лицевой счёт"},{"main-content":(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[i])),_:1}),(0,n.Wm)(R,{ref:"accordion"},{default:(0,n.w5)((()=>[(0,n.Wm)(D,{value:"first","toggle-icon":t.caretDownSharp},{default:(0,n.w5)((()=>[(0,n._)("div",r,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=e=>t.country=e),class:"input",placeholder:"Введите населенный пункт"},null,512),[[a.nr,t.country]])]),(0,n._)("div",c,[(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(H,{name:"bubbles"})])),_:1},512),[[a.F8,t.loading2]]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.ulusList,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.ulusId},[(0,n.Wm)(C,{lines:t.ulusList[t.ulusList?.length-1]?.ulus===e?.ulus&&"none",onClick:s=>t.fetchSettlementsHandler(e.ulusId,e.ulus)},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.ulus),1)])),_:2},1024)])),_:2},1032,["lines","onClick"])])))),128)),(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)("не найдено")])),_:1})])),_:1},512),[[a.F8,0===t.ulusList?.length]])])])),_:1},8,["toggle-icon"]),(0,n.Wm)(D,{value:"second","toggle-icon":t.caretDownSharp},{default:(0,n.w5)((()=>[(0,n._)("div",u,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=e=>t.settlement=e),class:"input",placeholder:"Введите населенный пункт"},null,512),[[a.nr,t.settlement]])]),(0,n._)("div",d,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.settlementsList,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.s_id},[(0,n.Wm)(C,{lines:t.settlementsList[t.settlementsList?.length-1]?.settlement===e?.settlement&&"none",onClick:s=>t.fetchStreetsHandler(e.s_id,e.settlement)},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.settlement),1)])),_:2},1024)])),_:2},1032,["lines","onClick"])])))),128)),(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)("не найдено")])),_:1})])),_:1},512),[[a.F8,0===t.settlementsList?.length]])])])),_:1},8,["toggle-icon"]),(0,n.Wm)(D,{value:"third","toggle-icon":t.caretDownSharp},{default:(0,n.w5)((()=>[(0,n._)("div",h,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=e=>t.street=e),class:"input",placeholder:"Введите улицу"},null,512),[[a.nr,t.street]])]),(0,n._)("div",p,[(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(H,{name:"bubbles"})])),_:1},512),[[a.F8,t.loading3]]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.streetsList,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.street},[(0,n.Wm)(C,{lines:t.streetsList[t.streetsList.length-1]?.street===e.street&&"none",onClick:s=>t.fetchHousesHandler(e.ids,e.street)},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.street),1)])),_:2},1024)])),_:2},1032,["lines","onClick"])])))),128)),(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)("не найдено")])),_:1})])),_:1},512),[[a.F8,0===t.streetsList?.length]])])])),_:1},8,["toggle-icon"]),(0,n.Wm)(D,{value:"fourth","toggle-icon":t.caretDownSharp},{default:(0,n.w5)((()=>[(0,n._)("div",w,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=e=>t.house=e),class:"input",placeholder:"Введите дом улицы"},null,512),[[a.nr,t.house]])]),(0,n._)("div",g,[(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(H,{name:"bubbles"})])),_:1},512),[[a.F8,t.loading4]]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.housesList,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e},[(0,n.Wm)(C,{lines:t.housesList[t.housesList.length-1]?.house===e?.house&&"none",onClick:s=>t.fetchLicsHandler(e?.house)},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e?.house),1)])),_:2},1024)])),_:2},1032,["lines","onClick"])])))),128)),(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)("не найдено")])),_:1})])),_:1},512),[[a.F8,0===t.housesList?.length]])])])),_:1},8,["toggle-icon"]),(0,n.wy)((0,n.Wm)(D,{value:"fifth","toggle-icon":t.caretDownSharp},{default:(0,n.w5)((()=>[(0,n._)("div",m,[(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=e=>t.apartment=e),class:"input",placeholder:"Введите номер квартиры"},null,512),[[a.nr,t.apartment]])]),(0,n._)("div",f,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.apartmentsList,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e},[(0,n.Wm)(C,{lines:t.apartmentsList[t.apartmentsList.length-1]?.apartment===e?.apartment&&"none",onClick:s=>t.fetchLicsHandler2(e?.apartment)},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e?.apartment),1)])),_:2},1024)])),_:2},1032,["lines","onClick"])])))),128)),(0,n.wy)((0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Uk)("не найдено")])),_:1})])),_:1},512),[[a.F8,0===t.apartmentsList?.length]])])])),_:1},8,["toggle-icon"]),[[a.F8,0!==t.housesList?.length&&void 0!==t.housesList&&t.housesList[0]?.apartments]])])),_:1},512),(0,n.wy)((0,n._)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.licsList,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t?.lics,(t=>((0,n.wg)(),(0,n.j4)(I,{key:t?.code},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{lines:"none",class:"check"},{default:(0,n.w5)((()=>[(0,n.Wm)(I,{class:"lics",slot:"start"},{default:(0,n.w5)((()=>[(0,n._)("p",_,"Лицевой счет: "+(0,o.zw)(t?.code),1),(0,n._)("p",y," Наименование лицевого счета: "+(0,o.zw)(t?.name),1)])),_:2},1024),(0,n.Wm)(N,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,slot:"end"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128))])))),128))],512),[[a.F8,0!==t.licsList?.length]]),(0,n.wy)((0,n._)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.licsApartmentsList,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t?.lics,(t=>((0,n.wg)(),(0,n.j4)(I,{key:t?.code},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{class:"check",lines:"none"},{default:(0,n.w5)((()=>[(0,n.Wm)(I,{class:"lics",slot:"start"},{default:(0,n.w5)((()=>[(0,n._)("p",k,"Лицевой счет: "+(0,o.zw)(t?.code),1),(0,n._)("p",v," Наименование лицевого счета: "+(0,o.zw)(t?.name),1)])),_:2},1024),(0,n.Wm)(N,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,slot:"end"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)))),128))])))),128))],512),[[a.F8,0!==t.housesList?.length&&void 0!==t.housesList&&t.housesList[0]?.apartments&&0!==t.licsApartmentsList?.length]]),(0,n.wy)((0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n._)("p",L,(0,o.zw)(t.response),1)])),_:1},512),[[a.F8,0!==t.response?.length]]),(0,n.wy)((0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n._)("p",S,(0,o.zw)(t.error),1)])),_:1},512),[[a.F8,0!==t.error?.length]])])),_:1},8,["method2","loading2"])])),_:1})}s(7658);var W=s(2201),$=s(594),I=s(8170),H=s(8903),C=s(4043),D=s(3978),R=s(6086),N=s(6651),P=(0,n.aZ)({name:"personalAccauntInfoSearchPage",components:{IonAccordionGroup:I.eh,IonAccordion:I.We,Back:C.Z,IonPage:I._i,Layout:$.Z,IonText:I.yW,IonItem:I.Ie,IonSpinner:I.PQ,IonCheckbox:I.nz},data(){return{error:"",house:"",street:"",settlement:"",settlementId:"",country:"",apartment:"",lc:[],loading:!1,response:[],arrMapLics:[],loading2:!0,loading3:!1,loading4:!1}},computed:{ulusList(){return this.$pinia.state.value?.personalAccount?.getSettlementsResponse?.data.filter((t=>t.ulus.toLowerCase().includes(this.$data.country.toLowerCase())))},settlementsList(){return this.ulusList?.filter((t=>t?.ulusId===this.$data.settlementId))[0]?.settlements?.filter((t=>t?.settlement?.toLowerCase().includes(this.$data.settlement.toLowerCase())))},streetsList(){return this.$pinia.state.value?.personalAccount?.getStreetsResponse?.data.flatMap((t=>t)).filter((t=>t.street.toLowerCase().includes(this.$data.street.toLowerCase())))},housesList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t)).filter((t=>t.house.toLowerCase().includes(this.$data.house.toLowerCase())))},apartmentsList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t?.apartments?.flatMap((t=>t)))).filter((t=>t?.apartment?.toLowerCase().includes(this.$data.apartment.toLowerCase())))},licsApartmentsList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t?.apartments?.flatMap((t=>t)))).filter((t=>t?.apartment?.toLowerCase()===this.$data.apartment.toLowerCase()))},licsList(){return this.$pinia.state.value?.personalAccount?.getHousesResponse?.data.flatMap((t=>t)).filter((t=>t.house.toLowerCase()===this.$data.house.toLowerCase()))}},mounted(){const t=new Promise((t=>{t(this.getSettlements())}));t.then((()=>this.$data.loading2=!1))},methods:{...(0,R.nv)(N.U,["getSettlements","getStreets","getHouses","addAccount","getAccount"]),onFocusText:function(){this.$refs.text.focus()},fetchSettlementsHandler(t,e){this.$data.settlementId=t,this.$data.country=e,this.$refs.accordion.$el.value=void 0},fetchStreetsHandler(t,e){this.$data.loading3=!0;const s=new Promise((e=>{e(this.getStreets(t))}));s.then((()=>this.$data.loading3=!1)),this.$refs.accordion.$el.value=void 0,this.$data.settlement=e},fetchHousesHandler(t,e){this.$data.loading4=!0;const s=new Promise((e=>{e(this.getHouses(t))}));s.then((()=>this.$data.loading4=!1)),this.$refs.accordion.$el.value=void 0,this.$data.street=e},fetchLicsHandler(t){this.$refs.accordion.$el.value=void 0,this.$data.house=t},fetchLicsHandler2(t){this.$refs.accordion.$el.value=void 0,this.$data.apartment=t},async addAccountHandler(){const t=new D.K;await t.create();const e=await t.get("token"),s=this.licsList[0]?.lics?.filter((t=>!0===t?.value)),n=this.licsApartmentsList[0]?.lics?.filter((t=>!0===t?.value));if(0!==s?.length&&void 0!==s||0!==n?.length&&void 0!==n){this.$data.loading=!0;const t=void 0!==s?s?.map((t=>t?.code)):n?.map((t=>t?.code)),a=new Promise((s=>{s(this.addAccount(JSON.parse(e).token,t))}));a.then((()=>{this.$data.error="",this.getAccount().then((()=>{this.$router.push("/tabs/personalAccounts")})),this.$data.loading=!1,this.$data.response=this.$pinia.state.value.personalAccount?.addAccountResponse[0]?.message}))}else this.$data.response="",this.$data.error="Выберите лицевой счет"}},setup(){const t=(0,W.tv)();return{router:t,pencilOutline:H.Tvs,documentTextOutline:H.L82,chevronForwardOutline:H.Dji,caretDownSharp:H.D2O}}}),b=s(3744);const V=(0,b.Z)(P,[["render",A],["__scopeId","data-v-553e7078"]]);var U=V}}]);
//# sourceMappingURL=4841.c76bd9e5.js.map