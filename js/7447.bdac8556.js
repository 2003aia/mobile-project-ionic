"use strict";(self["webpackChunkstng"]=self["webpackChunkstng"]||[]).push([[7447],{7447:function(l,e,t){t.r(e),t.d(e,{default:function(){return Y}});t(7658);var a=t(6252),i=t(9963),n=t(3577);const s=l=>((0,a.dD)("data-v-24280366"),l=l(),(0,a.Cn)(),l),o={class:"modal-header"},d={class:"modal"},u=s((()=>(0,a._)("p",{class:"title"},"Удаление аккаунта",-1))),r=s((()=>(0,a._)("p",{class:"ion-text-center",style:{"margin-top":"20px",color:"black"}},"Вы точно хотите удалить аккаунт?",-1))),c={class:"confirmWrapper"},m={class:"modal-header"},p={class:"modal"},f=s((()=>(0,a._)("p",{class:"blue"},"Принято.",-1))),w={class:"confirmWrapper"},h=s((()=>(0,a._)("p",{class:"title ion-text-start"},"Мои данные",-1))),_={key:0,class:"sub-title"},W={key:1},g={key:0,class:"sub-title"},D={key:1},k={key:0,class:"sub-title"},b={key:1},y={key:0,class:"sub-title"},$={key:1},I=s((()=>(0,a._)("p",null," Данные паспорта ",-1))),v=s((()=>(0,a._)("p",null,"Паспорт выдан",-1))),O={class:"sub-title"},P=s((()=>(0,a._)("p",null," Дата выдачи паспорта ",-1))),C={class:"sub-title"},E=s((()=>(0,a._)("p",null," Номер паспорта ",-1))),x={class:"sub-title"},S=s((()=>(0,a._)("p",null," Серия паспорта ",-1))),z={class:"sub-title"},F={key:0,class:"sub-title"},H={key:1},M=s((()=>(0,a._)("p",null,"Согласие на получения смс",-1))),U=s((()=>(0,a._)("p",null,"Согласие на получения квитанций на эл. почту",-1)));function A(l,e,t,s,A,B){const L=(0,a.up)("Back"),V=(0,a.up)("ion-icon"),Z=(0,a.up)("ion-text"),J=(0,a.up)("ion-button"),N=(0,a.up)("ion-spinner"),K=(0,a.up)("ion-modal"),j=(0,a.up)("Input"),G=(0,a.up)("ion-item"),Q=(0,a.up)("ion-checkbox"),R=(0,a.up)("Layout"),T=(0,a.up)("ion-page");return(0,a.wg)(),(0,a.j4)(T,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,{title:"Личный кабинет",btnSrc:()=>l.router.push("/tabs/personalAccounts")},null,8,["btnSrc"]),(0,a.Wm)(R,{height:"false",method:()=>{l.router.push("/tabs/profileEdit")},method2:()=>{l.router.push("/tabs/newPassPage")},id3:"open-modal2",filledBtn:"Редактировать",title:"Личный кабинет",outlineBtn:"Изменить пароль",filledBtn2:"Удалить аккаунт"},{"main-content":(0,a.w5)((()=>[(0,a.Wm)(K,{ref:"modal2",trigger:"open-modal2",onWillDismiss:l.onWillDismiss,mode:"ios"},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(V,{onClick:l.cancel,icon:l.closeOutline},null,8,["onClick","icon"])]),(0,a._)("div",d,[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[u,r])),_:1}),(0,a._)("div",c,[(0,a.Wm)(J,{onClick:l.cancel,fill:"clear"},{default:(0,a.w5)((()=>[(0,a.Uk)("НЕТ")])),_:1},8,["onClick"]),(0,a.wy)((0,a.Wm)(J,{onClick:l.deleteHandler,fill:"clear",style:{color:"red",border:"solid red 1px","margin-left":"10px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("ДА")])),_:1},8,["onClick"]),[[i.F8,!l.loading]]),(0,a.wy)((0,a.Wm)(J,{fill:"clear",style:{color:"red",border:"solid red 1px","margin-left":"10px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{name:"bubbles"})])),_:1},512),[[i.F8,l.loading]])])])])),_:1},8,["onWillDismiss"]),(0,a.Wm)(K,{ref:"modal3","is-open":l.isOpen,mode:"ios",onWillDismiss:l.onWillDismiss2},{default:(0,a.w5)((()=>[(0,a._)("div",m,[(0,a.Wm)(V,{onClick:e[0]||(e[0]=e=>l.cancel2()),icon:l.closeOutline},null,8,["icon"])]),(0,a._)("div",p,[(0,a.Wm)(j,{name:"Электронная почта",value:l.email,changeHandler:e=>l.email=e.target.value},null,8,["value","changeHandler"]),(0,a.wy)((0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[f])),_:1},512),[[i.F8,this.profileData?.email.length>0]]),(0,a._)("div",w,[(0,a.Wm)(J,{style:{color:"red",border:"solid red 1px","margin-right":"10px"},onClick:l.cancel2,fill:"clear"},{default:(0,a.w5)((()=>[(0,a.Uk)("ОТМЕНА")])),_:1},8,["onClick"]),(0,a.wy)((0,a.Wm)(J,{disabled:!l.email,onClick:l.editHandler,fill:"clear"},{default:(0,a.w5)((()=>[(0,a.Uk)("ГОТОВО")])),_:1},8,["disabled","onClick"]),[[i.F8,!l.loadingEmail]]),(0,a.wy)((0,a.Wm)(J,{fill:"clear"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{name:"bubbles"})])),_:1},512),[[i.F8,l.loadingEmail]])])])])),_:1},8,["is-open","onWillDismiss"]),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[h])),_:1}),(0,a._)("div",null,[(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[l.profileData?.surname?((0,a.wg)(),(0,a.iD)("p",_,(0,n.zw)(l.profileData?.surname),1)):((0,a.wg)(),(0,a.iD)("p",W,"Фамилия"))])),_:1})])),_:1}),(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[l.profileData?.name?((0,a.wg)(),(0,a.iD)("p",g,(0,n.zw)(l.profileData?.name),1)):((0,a.wg)(),(0,a.iD)("p",D,"Имя"))])),_:1})])),_:1}),(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[l.profileData?.lastname?((0,a.wg)(),(0,a.iD)("p",k,(0,n.zw)(l.profileData?.lastname),1)):((0,a.wg)(),(0,a.iD)("p",b,"Отчество"))])),_:1})])),_:1}),(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[l.profileData?.email?((0,a.wg)(),(0,a.iD)("p",y,(0,n.zw)(l.profileData?.email),1)):((0,a.wg)(),(0,a.iD)("p",$,"Электронная почта"))])),_:1})])),_:1}),(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[I])),_:1})])),_:1}),(0,a.wy)((0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[v])),_:1}),(0,a.Wm)(Z,{slot:"end"},{default:(0,a.w5)((()=>[(0,a._)("p",O,(0,n.zw)(l.profileData?.passport?.issuedBy),1)])),_:1})])),_:1},512),[[i.F8,l.profileData?.passport?.issuedBy]]),(0,a.wy)((0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[P])),_:1}),(0,a.Wm)(Z,{slot:"end"},{default:(0,a.w5)((()=>[(0,a._)("p",C,(0,n.zw)(l.profileData?.passport.issuedDate),1)])),_:1})])),_:1},512),[[i.F8,l.profileData?.passport.issuedDate]]),(0,a.wy)((0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[E])),_:1}),(0,a.Wm)(Z,{slot:"end"},{default:(0,a.w5)((()=>[(0,a._)("p",x,(0,n.zw)(l.profileData?.passport?.number),1)])),_:1})])),_:1},512),[[i.F8,l.profileData?.passport?.number]]),(0,a.wy)((0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[S])),_:1}),(0,a.Wm)(Z,{slot:"end"},{default:(0,a.w5)((()=>[(0,a._)("p",z,(0,n.zw)(l.profileData?.passport?.serial),1)])),_:1})])),_:1},512),[[i.F8,l.profileData?.passport?.serial]]),(0,a.wy)((0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" СНИЛС ")])),_:1}),(0,a.Wm)(Z,{slot:"end",class:"sub-title"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(l.profileData?.snils),1)])),_:1})])),_:1},512),[[i.F8,l.profileData?.snils]]),(0,a.wy)((0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" Код подразделения ")])),_:1}),(0,a.Wm)(Z,{slot:"end",class:"sub-title"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(l.profileData?.passport?.codePodr),1)])),_:1})])),_:1},512),[[i.F8,l.profileData?.passport?.codePodr]]),(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[l.login?((0,a.wg)(),(0,a.iD)("p",F,(0,n.zw)(l.login),1)):((0,a.wg)(),(0,a.iD)("p",H,"Контактный телефон"))])),_:1})])),_:1}),(0,a.Wm)(G,{class:"check"},{default:(0,a.w5)((()=>[(0,a.Wm)(Q,{slot:"start","onUpdate:modelValue":e[1]||(e[1]=e=>l.checkHandler(1,e)),modelValue:l.consentSMS},null,8,["modelValue"]),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[M])),_:1})])),_:1}),(0,a.Wm)(G,{class:"check"},{default:(0,a.w5)((()=>[(0,a.Wm)(Q,{id:"open-modal3",slot:"start","onUpdate:modelValue":e[2]||(e[2]=e=>l.checkHandler(2,e)),modelValue:l.consentEMAIL},null,8,["modelValue"]),(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[U])),_:1})])),_:1})])])),_:1},8,["method","method2"])])),_:1})}var B=t(2201),L=t(1993),V=t(23),Z=t(7821),J=t(7698),N=t(6086),K=t(3978),j=t(8903),G=t(9196),Q=(0,a.aZ)({name:"profilePage",data(){return{codeSent:!1,edit:!1,login:"",consentSMS:!1,consentEMAIL:!1,loading:!1,loadingEmail:!1,isOpen:!1,email:""}},methods:{...(0,N.nv)(J.O,["getProfile","editProfile","deleteAcc"]),checkHandler(l,e){if(1===l){const l={consenttosms:e};this.editProfile(l)}if(2===l){if(0===this.profileData?.email.length&&!0===e&&(this.$data.isOpen=!0,this.$data.consentEMAIL=!1,this.$data.isEmail=e),!1===e){this.$data.isOpen=!1;const l={consenttoemail:e};this.$data.isOpen=!1,this.editProfile(l)}if(this.profileData?.email.length>0&&!0===e){const l={consenttoemail:e};this.$data.isOpen=!1,this.editProfile(l)}}},onWillDismiss(l){"confirm"===l.detail.role&&(this.message=`Hello, ${l.detail.data}!`)},onWillDismiss2(){0===this.profileData?.email.length?this.$data.consentEMAIL=null:this.$data.consentEMAIL=!0},setOpen(l){this.$data.isOpen=l},cancel(){this.$refs.modal2.$el.dismiss(null,"cancel")},cancel2(){this.$data.isOpen=!1,this.$refs.modal3.$el.dismiss(null,"cancel")},editHandler(){this.$data.loadingEmail=!0;const l={email:this.$data.email,consenttoemail:!0};this.editProfile(l).then((()=>{this.$data.loadingEmail=!1,this.getProfile()}))},deleteHandler(){this.$data.loading=!0,this.deleteAcc().then((async()=>{this.$data.loading=!1,this.$refs.modal2.$el.dismiss(null,"cancel"),this.$router.push("/authPage");const l=new K.K;await l.create();const e=await l.get("token");await l.set("token",JSON.stringify({phone:JSON.parse(e).phone}))}))}},computed:{profileData(){return this.$pinia.state.value?.profile?.profileResponse?.data}},ionViewDidEnter(){const l=async()=>{const l=new K.K;await l.create();const e=await l.get("token");this.$data.login=JSON.parse(e).phone};l(),this.getProfile().then((()=>{this.$data.consentSMS=this.profileData?.consenttosms,this.$data.consentEMAIL=this.profileData?.consenttoemail}))},components:{IonPage:Z._i,Back:V.Z,Layout:L.Z,IonItem:Z.Ie,IonText:Z.yW,IonCheckbox:Z.nz,IonModal:Z.ki,IonIcon:Z.gu,Input:G.Z,IonButton:Z.YG,IonSpinner:Z.PQ},setup(){const l=(0,B.tv)();return{router:l,closeOutline:j.fID}}}),R=t(3744);const T=(0,R.Z)(Q,[["render",A],["__scopeId","data-v-24280366"]]);var Y=T}}]);
//# sourceMappingURL=7447.bdac8556.js.map