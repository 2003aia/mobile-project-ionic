{"version":3,"file":"js/8158.cf7bb4b2.js","mappings":"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","sources":["webpack://stng/./src/stores/preEntry.js","webpack://stng/./src/views/Date.vue","webpack://stng/./src/views/Date.vue?874f"],"sourcesContent":["import { defineStore } from \"pinia\";\r\nimport axios from \"axios\";\r\nimport { isPlatform } from \"@ionic/vue\";\r\nimport { Storage } from '@ionic/storage'\r\n\r\nlet apiUrlStng2 = 'https://fhd.aostng.ru/vesta/hs/API_STNG/V2/'\r\n\r\n\r\nexport const usePreEntryStore = defineStore({\r\n  id: \"preEntry\",\r\n  state: () => ({\r\n    entryPhone: \"\",\r\n    entryServiceType: \"\",\r\n    entryDate: null,\r\n    entryAvailableTimes: [],\r\n    entryTime: null,\r\n    entryNumber: null,\r\n\r\n\r\n    availableDates: null,\r\n    availableDatesError: null,\r\n    availableTimeSlots: null,\r\n    availableTimeSlotsError: null,\r\n    postReserveResponse: null,\r\n    postReserveError: null,\r\n    deleteReserveError: null,\r\n    deleteReserveResponse: null,\r\n    reserveData: null,\r\n    getReserveResponse: null,\r\n    getReserveError: null,\r\n\r\n  }),\r\n  getters: {\r\n    getEntryInfo: (state) => {\r\n      return {\r\n        entryPhone: state.entryPhone,\r\n        entryServiceType: state.entryServiceType,\r\n        entryDate: state.entryDate,\r\n        entryAvailableTimes: state.entryAvailableTimes,\r\n        entryTime: state.entryTime,\r\n      };\r\n    },\r\n  },\r\n  actions: {\r\n    async getDates(operation) {\r\n      try {\r\n        await axios\r\n          .get(`${apiUrlStng2}/elGetDatas?operation=${operation}`)\r\n          .then((response) => (this.availableDates = response.data));\r\n      } catch (error) {\r\n        this.availableDatesError = error;\r\n      }\r\n    },\r\n    async getTimeSlots(operation, date) {\r\n      try {\r\n        await axios\r\n          .get(`${apiUrlStng2}/elGetTimes?operation=${operation}&date=${date}`)\r\n          .then((response) => (this.availableTimeSlots = response.data));\r\n      } catch (error) {\r\n        this.availableTimeSlotsError = error;\r\n      }\r\n    },\r\n    async postReserve(data) {\r\n      try {\r\n        await axios\r\n          .post(`${apiUrlStng2}/elReserve`, data)\r\n          .then((response) => (this.postReserveResponse = response.data));\r\n      } catch (error) {\r\n        this.postReserveError = error;\r\n      }\r\n    },\r\n    async deleteReserve(id) {\r\n      try {\r\n        await axios\r\n          .get(`${apiUrlStng2}/elDelete?id=${id}`)\r\n          .then((response) => (this.deleteReserveResponse = response.data));\r\n      } catch (error) {\r\n        this.deleteReserveError = error;\r\n      }\r\n    },\r\n    async getReserve() {\r\n      const store = new Storage()\r\n      await store.create()\r\n      const token = await store.get('token')\r\n      const parsedToken = JSON.parse(token)\r\n      try {\r\n        await axios\r\n          .get(`${apiUrlStng2}/elQueye?token=${parsedToken?.token}`)\r\n          .then((response) => (this.getReserveResponse = response.data));\r\n      } catch (error) {\r\n        this.getReserveError = error;\r\n      }\r\n    },\r\n\r\n    async setPhone(phone) {\r\n      this.entryPhone = phone;\r\n    },\r\n    async setServiceType(type) {\r\n      this.entryServiceType = type;\r\n    },\r\n    async setDate(date) {\r\n      this.entryDate = date;\r\n    },\r\n    async setTime(time) {\r\n      this.entryTime = time;\r\n    },\r\n    async fetchTime() {\r\n      if (this.entryDate && this.entryServiceType != \"\") {\r\n        try {\r\n          let config = {\r\n            headers: {\r\n              Accept: \"*/*\",\r\n              \"Content-Type\": \"multipart/form-data\",\r\n            },\r\n          };\r\n\r\n          let device = \"android\";\r\n          if (isPlatform(\"iphone\")) {\r\n            device = \"iphone\";\r\n          }\r\n\r\n          var bodyFormData = new FormData();\r\n          bodyFormData.append(\"date\", this.entryDate);\r\n          bodyFormData.append(\"service\", this.entryServiceType);\r\n          bodyFormData.append(\"ionicDevice\", device);\r\n\r\n          const response = await axios.post(\r\n            `https://aostng.ru/ajax/preregajax.php`,\r\n            bodyFormData,\r\n            config\r\n          );\r\n\r\n          let values = [];\r\n          // Get values between <option value=\"##:##:##\"> and </option>\r\n          const re = />([^<.]+)<\\//g;\r\n          let match = re.exec(response.data);\r\n          while (match != null) {\r\n            values.push(match[1]);\r\n            match = re.exec(response.data);\r\n          }\r\n\r\n          this.entryTime = null;\r\n          this.entryAvailableTimes = values;\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      }\r\n    },\r\n\r\n    async sendFullInfo(phone, type, date, time) {\r\n      console.log(phone, type, date, time);\r\n      try {\r\n        let config = {\r\n          headers: {\r\n            Accept: \"*/*\",\r\n            \"Content-Type\": \"multipart/form-data\",\r\n          },\r\n        };\r\n        let device = \"android\";\r\n        if (isPlatform(\"iphone\")) {\r\n          device = \"iphone\";\r\n        }\r\n\r\n        var bodyFormData = new FormData();\r\n        bodyFormData.append(\"number\", phone);\r\n        bodyFormData.append(\"service\", type);\r\n        bodyFormData.append(\"date\", date);\r\n        bodyFormData.append(\"time\", time);\r\n        bodyFormData.append(\"ionicDevice\", device);\r\n\r\n        await axios.post(`https://aostng.ru/prereg2.php`, bodyFormData, config).then((response) => {\r\n          this.entryNumber = response.data.split('Номер вашей брони - </span>')[1]\r\n        })\r\n        return true;\r\n      } catch (error) {\r\n        return false;\r\n      }\r\n    },\r\n\r\n    async resetPreEntry() {\r\n      this.entryPhone = \"\";\r\n      this.entryServiceType = \"\";\r\n      this.entryDate = null;\r\n      this.entryAvailableTimes = [];\r\n      this.entryTime = null;\r\n    },\r\n  },\r\n});\r\n","<template>\r\n  <ion-page>\r\n    <Back />\r\n    <Layout height=\"false\" filledBtn=\"Готово\" outlineBtn=\".\" :btnSrc=\"'/tabs/record'\" :method=\"() => clickFilledBtn()\"\r\n      :title=\"time === true ? 'Выберите время' : 'Выберите дату'\">\r\n      <template v-slot:main-content>\r\n        <ion-datetime v-show=\"availableDatesData?.data?.length > 0\" color=\"date\" presentation=\"date\"\r\n          @ionChange=\"onDateChange\" mode=\"ios\" :dayValues=\"availableDates\"></ion-datetime>\r\n\r\n        <div v-show=\"!reserveData?.operation && !availableDatesData\">\r\n          <ion-item lines=\"none\" router-link=\"/tabs/record\">\r\n            <ion-text class=\"sub-title\">Выберите вид услуг</ion-text>\r\n          </ion-item>\r\n        </div>\r\n        <div v-show=\"availableDatesData?.data?.length === 0 && reserveData?.operation\">\r\n          <ion-item lines=\"none\" router-link=\"/tabs/record\">\r\n            <ion-text class=\"sub-title\">Свободных дней нет</ion-text>\r\n          </ion-item>\r\n        </div>\r\n        <div v-show=\"availableDatesData?.error === true\">\r\n          <ion-item lines=\"none\" router-link=\"/tabs/record\">\r\n            <ion-text class=\"sub-title\">{{ availableDatesData?.message }}</ion-text>\r\n          </ion-item>\r\n        </div>\r\n\r\n      </template>\r\n    </Layout>\r\n  </ion-page>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport Layout from \"../components/Layout.vue\";\r\nimport Back from \"../components/Back.vue\";\r\nimport { IonPage, IonDatetime, IonText, IonItem } from \"@ionic/vue\";\r\n// import { getDate, getMonth } from \"date-fns\";\r\n// import { isWeekend } from \"date-fns\";\r\nimport moment from 'moment'\r\nimport { usePreEntryStore } from \"../stores/preEntry\";\r\n\r\nexport default defineComponent({\r\n  name: \"timePage\",\r\n  props: {\r\n    time: Boolean,\r\n  },\r\n  data() {\r\n    return {\r\n      availableDates: '1',\r\n    }\r\n  },\r\n  components: {\r\n    IonPage,\r\n    Back,\r\n    IonDatetime,\r\n    Layout,\r\n    IonText, IonItem\r\n  },\r\n\r\n  setup() {\r\n    const router = useRouter();\r\n    const { getTimeSlots, } = usePreEntryStore();\r\n\r\n    /* let returnTo = router.options.history.state.back;\r\n    let selectedDateTime = null;\r\n\r\n    const isDateEnabled = (dateIsoString) => {\r\n      const date = new Date(dateIsoString);\r\n\r\n      return !isWeekend(date);\r\n    };\r\n    \r\n    let today = new Date().toISOString();\r\n    let maxDay = new Date();\r\n    maxDay.setDate(maxDay.getDate() + 5);\r\n    maxDay = maxDay.toISOString(); */\r\n\r\n    return {\r\n      router,\r\n      getTimeSlots,\r\n      // returnTo,\r\n      // selectedDateTime,\r\n      // isDateEnabled,\r\n      // setDate,\r\n      // fetchTime,\r\n      // today,\r\n      // maxDay,\r\n    };\r\n  },\r\n  computed: {\r\n    reserveData() {\r\n      return this.$pinia.state.value.preEntry.reserveData\r\n    },\r\n    availableDatesData() {\r\n      return this.$pinia.state.value.preEntry.availableDates\r\n    },\r\n  },\r\n  ionViewDidEnter() {\r\n    this.$data.availableDates = ''\r\n    this.$pinia.state.value.preEntry.availableDates?.data?.forEach(element => {\r\n      this.$data.availableDates += `${element.slice(-2)},`\r\n    });\r\n    // console.log(this.$pinia.state.value.preEntry.reserveData, 'testets')\r\n  },\r\n  methods: {\r\n    onDateChange(event) {\r\n      this.$pinia.state.value.preEntry.reserveData = { date: moment(event.detail.value).format('yyyy-MM-DD'), ...this.reserveData }\r\n    },\r\n\r\n    clickFilledBtn() {\r\n      if (this.time === false) {\r\n        this.getTimeSlots(this.reserveData?.operation, this.reserveData?.date)\r\n      }\r\n    },\r\n  },\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.background {\r\n  height: 100%;\r\n}\r\n\r\n.container {\r\n  padding: 15px;\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.header {\r\n  padding: 15px;\r\n  padding-top: 84px;\r\n  padding-bottom: 56px;\r\n  background: linear-gradient(327.65deg, #0378b4 -6.98%, #7ae6e4 119.27%);\r\n}\r\n\r\n.main {\r\n  background: #ffffff;\r\n  padding: 15px;\r\n  border-radius: 15px;\r\n  position: relative;\r\n  top: -50px;\r\n  left: 0;\r\n  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.button {\r\n  margin-top: -30px;\r\n}\r\n</style>\r\n","import { render } from \"./Date.vue?vue&type=template&id=446d8350&scoped=true\"\nimport script from \"./Date.vue?vue&type=script&lang=js\"\nexport * from \"./Date.vue?vue&type=script&lang=js\"\n\nimport \"./Date.vue?vue&type=style&index=0&id=446d8350&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\aia\\\\Desktop\\\\STNG-MOBILE\\\\mobile-project-ionic\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-446d8350\"]])\n\nexport default __exports__"],"names":["apiUrlStng2","usePreEntryStore","defineStore","id","state","entryPhone","entryServiceType","entryDate","entryAvailableTimes","entryTime","entryNumber","availableDates","availableDatesError","availableTimeSlots","availableTimeSlotsError","postReserveResponse","postReserveError","deleteReserveError","deleteReserveResponse","reserveData","getReserveResponse","getReserveError","getters","getEntryInfo","actions","async","operation","axios","then","response","this","data","error","date","store","Storage","create","token","get","parsedToken","JSON","parse","phone","type","time","config","headers","Accept","device","isPlatform","bodyFormData","FormData","append","values","re","match","exec","push","console","log","split","_createBlock","_component_ion_page","_createVNode","_component_Back","_component_Layout","height","filledBtn","outlineBtn","btnSrc","method","_ctx","title","_component_ion_datetime","color","presentation","onIonChange","mode","dayValues","length","_createElementVNode","_component_ion_item","lines","_component_ion_text","class","message","defineComponent","name","props","Boolean","components","IonPage","Back","IonDatetime","Layout","IonText","IonItem","setup","router","useRouter","getTimeSlots","computed","$pinia","value","preEntry","availableDatesData","ionViewDidEnter","$data","forEach","element","slice","methods","onDateChange","event","moment","detail","format","clickFilledBtn","__exports__","render"],"sourceRoot":""}